{
  "hash": "0cb323ee868669850450754d3a905075",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: Processando dados de sequenciamento Sanger\n\nimage: \"thumb.png\"\ncategories: [Bioinformatics, Tutorial, Sanger]\n\ndate: \"2025-11-05\"\ndate-format: \"long\"\n\nauthor: \n  - name: Gabriel Rodrigues\n    degrees: \n      - MSc\n    id: gr\n    orcid: 0009-0005-2294-2845\n    email: gvpina.rodrigues@gmail.com\n    affiliation: \n      - name: Universidade Estadual de Santa Cruz\n        city: Ilhéus\n        state: Bahia\n        url: www.uesc.br\n\nabstract: > \n  Atividade Prática realizada no dia 05/11/2025, na disciplina de \"Filogenia Molecular\", ministrada pelo Prof. Marco A. Costa, na Universidade Estadual de Santa Cruz (UESC) pelo Programa de Pós-Graduação em Genética e Biologia Molecular.\nkeywords:\n  - Árvore Filogenética\n  - Evolução\n  - Métdos Moleculares\n\nlightbox: true\nformat:\n    html:\n        number-sections: true\n        # theme: flatly\n        # code-fold: true\n        # code-summary: \"Mostrar Código\"\n        toc: true\n        toc_float: true\n        self-contained: true\n        other-links:\n        - text: Website\n          href: https://gabrielvpina.github.io/myBlog/\n\nlang: pt\n---\n\n# Atividade\n\nEditar as sequências contidas nos eletroferogramas anexos, gerando um arquivo word com as sequências Forward e Reverse, e as sequências consenso. Verificar qual espécie no banco de dados do NCBI apresenta maior identidade com cada sequência consenso obtida.\n\n# Metodologia\n\nA atividade deveria ser realizada a partir do software [BioEdit](https://thalljiscience.github.io/), entretanto não foi possível encontrar binários do software que fossem suportados pelo sistema operacional Linux (Archinux), que atualmente está sendo utilizado pelo discente.\n\nPara contornar a situação, serão adotadas estratégias de processamento para processar os dados resultantes do sequenciamento Sanger (eletroferograma), que sigam os mesmos passos do tutorial apresentado em sala de aula. \n\n## Análise dos arquivos .ab1\n\nArquivos *.ab1* são dados brutos vindos de sequenciadores tipo Sanger. Esses arquivos possuem a sequência do DNA analisada, um eletroferograma (um gráfico mostrando os picos de fluorenscência para cada base) e uma pontuação de qualidade associada à cada base da sequência.\n\nNesse caso vamos utilizar o software [CutePeaks](https://github.com/labsquare/CutePeaks) para realizar o *basecalling*, a chamada das bases individuais da sequência analisada, para conferir seu pico de fluorescência e sua qualidade. \n\n![Exemplo de arquivo .ab1 lido pelo software CutePeaks](figures/cutepeaks.png)\n\n## Conversão de .ab1 para .fastq\n\nComo não será possível trabalhar diretamente com o software *BioEdit*, será necessário realizar a conversão dos arquivos arquivos *.ab1* para o formato *.fastq*, formato padrão dos dados brutos de sequenciadores de nova gereação, como os da plataforma *Illumina*.\n\nPara realizar essa conversão, foi utilizada a biblioteca BioPython (suportada pela linguagem de programação Python) para criar o arquivo `abi2fastq.py` com o seguinte código:\n\n::: {#9d214b15 .cell execution_count=1}\n``` {.python .cell-code}\n# Importando a biblioteca BioPython\nfrom Bio import SeqIO\nimport sys\n\n# Definindo a entrada e a saída dos arquivos\nentrada = sys.argv[1]\nsaida = sys.argv[2]\n\n# Realizando a conversão dos dados\nrecords = SeqIO.parse(entrada, \"abi\")\ncount = SeqIO.write(records, saida, \"fastq\")\n```\n:::\n\n\nO arquivo `abi2fastq.py` pode ser utilizado para inserir os dois argumentos para a conversão, o nome do aruivo de entrada e o nome do arquivo de saída (que será a conversão). Para rodar o código e realizar a conversão, executa-se no terminal linux:\n```{bash}\n\npython abi2fastq.py COC_2F.ab1 COC_2F.fastq\n\n```\n\nCom isso teremos nosso arquivo *.ab1* convertido para formato *.fastq*, seguindo essa estrutura:\n\n```{bash}\n@13F\nNNNNNNNNGNTGATATCANGAGTTTATATTTTAATTTTACCAGGATTTGGACTAATTTCACAAA\nTTATTATAAATGAAAGAGGAAAAAAGGAAATTTTTGGAAATTTAAGAATAATTTATGCTATATT\nAGGAATTGGATTTTTAGGATTTATTGTATGAGCTCATCATATATTTACTGTAGGATTAGATGTT\nGATACACGAGCATATTTTACATCTGCAACAATAATTATTGCAATTCCTACAGGAATTAAAGTTT\nTTAGATGATTAGCAACTTATCATGGATCAAAATTAAATTTTAATATTTCATTTATATGATCAAT\nTGGATTTATTTTAATATTTACTATTGGAGGATTAACAGGAATTATATTATCAAATTCATCAATT\nGATATTATTTTACATGATTCTTATTACGTAGTTGGTCATTTTCACTATGTATTATCTATAGGAG\nCAGTATTTTCCATTATTGCAAGATTTATTCATTGATTTCCCTTATTATCAGGATTAATAATTAA\nTCAAAAATGATTAAAATTTCAATTTTTTTTTATATTCATTGGAATTAATTTCACTTTTTTTCCT\nCAACATTTTTTAGGATTAATATCAGATCAAATGGAAATTACGGCACTTATGGATAATACATAGT\nGAAAATGACCAACTCCGTATTAAGACTCATTGTATCAT\n+\n\"$$$$%%%&%&')),)&+%,7)7M<>=@A[[;F<KTU7DJ20PQ62U__L@<JJGPY_G8YTIY\n___WW_Y99H8G=<EL_\\_\\Y\\\\O\\____\\\\_\\\\\\_Y\\\\\\\\__\\\\\\_____\\___\\_\\\\\\\\___\n\\HYWYR__\\RG==LL\\\\_\\\\__W___\\\\___TYY\\RYQAY\\\\Y___W___T\\T_\\\\T\\=IOYEQ\nWOYY\\LTDLCELTSDQQ@YLEYY_____________________W________\\__________\n___\\___\\\\________________W_____________________W_________W______\n___\\__________________________\\\\_____________________RR_________\n_\\______________\\_______________________________________________\n______________________W_______YFF_W_O__O____________PW__________\n_______W__W_________________OO______WPOO_L_[[[[[[[[[U[[[[[[[[[[W\n[QUWUWW[[[LLUW[UIWKPUJG-&&,5H''*130/,3B:,8K/**'.(9(>3@/',-*'+*?(\n4+*2/-J****'*(+(43-*3/*<''/**1(B+2*+)(\n```\n\nOnde o identificador da sequência é o `@13F` e a pontuação *Phred* de qualidade está localizada abaixo do símbolo de `+`. Em termos práticos esse arquivo informa a sequência e a qualidade das bases, mas diferente do formato anterior, os picos de fluorescência não são informados. \n\n## Checagem da qualidade dos arquivos fastq\n\nPara checar se a conversão foi realizada corretamente, os arquivos de qualidade das sequências *.fastq* foram comparadas com a qualidade exibida no eletroferograma e checada no *CutePeaks*. Essa checagem foi realizada com o software [FastQC](https://www.bioinformatics.babraham.ac.uk/projects/fastqc/).\n\n![Qualidade do eletroferograma do arquivo RBA_2R no software CutePeaks, a qualidade é representada pelas barras cinzas](figures/cp_comparison.png)\n\n![Checagem de qualidade do arquivo fastq (RBA_2R), através do software FastQC](figures/fastqc.png)\n\n## Remoção das bases de baixa qualidade\n\nPara a remoção das bases de baixa qualidade foi utilizado o software [Seqtk](https://github.com/lh3/seqtk), em sua função `trimfq`, que remove automaticamente as sequências de baixa qualidade (*Phred* < 15) e bases não definidas.\n\nAs análises de quailidade também foram realizadas nas sequências após a remoção das bases de baixa qualidade.\n\n## Conversão de FASTQ para FASTA\n\nApós a trimagem das sequências e remoção de bases de não definidas, os arquivos *FASTQ* foram comvertidos para o formato *FASTA* através da biblioteca **BioPython**, seguindo a mesma lógica da conversão dos arquivos *.ab1*:\n\n::: {#144453f2 .cell execution_count=2}\n``` {.python .cell-code}\n# Importando a biblioteca BioPython\nfrom Bio import SeqIO\nimport sys\n\n# Definindo a entrada e a saída dos arquivos\nentrada = sys.argv[1]\nsaida = sys.argv[2]\n\n# Realizando a conversão dos dados\nrecords = SeqIO.parse(entrada, \"fastq\")\ncount = SeqIO.write(records, saida, \"fasta\")\n```\n:::\n\n\nO arquivo final `fastq2fasta.py` então é chamado no terminal linux:\n\n```{bash}\n\npython fastq2fasta.py COC_2F.fastq COC_2F.fasta\n\n```\n\nUm arquivo em formato FASTA se assemelha à um arquivo FASTQ, porém sem os índices de qualidade por base (*Phred Score*) anexados ao arquivo das sequências. Outra diferença são os símbolos adotados, o *header* de uma sequência (seu cabeçalho) agora é marcado pelo símbolo `>` antes do nome da sequência. \n\n## Obtenção da Sequência Consenso\n\nA sequência conseso é o resultado da união via sobreposição das sequências *foward* e *reverse* do sequenciemanto. Para fazer a montegem dessas sequências em uma única final. Para isso pode-se utilizar o software [CAP3](https://doua.prabi.fr/software/cap3), que alinha a sobreposição das sequências para estabelecer as contigs finais, uma técnica denominada de *Overlap Layout Consensus*.\n\nA entrada para o software CAP3 foi um arquivo FASTA com a junção das duas sequências (*foward* e *reverse*) de cada amostra, dessa maneira (Arquivo **COC_merge.fasta**):\n\n```{bash}\n>13F\nTTTATATTTTAATTTTACCAGGATTTGGACTAATTTCACAAATTATTATAAATGAAAGAG\nGAAAAAAGGAAATTTTTGGAAATTTAAGAATAATTTATGCTATATTAGGAATTGGATTTT\nTAGGATTTATTGTATGAGCTCATCATATATTTACTGTAGGATTAGATGTTGATACACGAG\nCATATTTTACATCTGCAACAATAATTATTGCAATTCCTACAGGAATTAAAGTTTTTAGAT\nGATTAGCAACTTATCATGGATCAAAATTAAATTTTAATATTTCATTTATATGATCAATTG\nGATTTATTTTAATATTTACTATTGGAGGATTAACAGGAATTATATTATCAAATTCATCAA\nTTGATATTATTTTACATGATTCTTATTACGTAGTTGGTCATTTTCACTATGTATTATCTA\nTAGGAGCAGTATTTTCCATTATTGCAAGATTTATTCATTGATTTCCCTTATTATCAGGAT\nTAATAATTAATCAAAAATGATTAAAATTTCAATTTTTTTTTATATTCATTGGAATTAATT\nTCACTTTTTTTCCTCAACATTTTTTAGGATTAATATC\n>13R\nAAAAAAAAATTGAAATTTTAATCATTTTTGATTAATTATTAATCCTGATAATAAGGGAAA\nTCAATGAATAAATCTTGCAATAATGGAAAATACTGCTCCTATAGATAATACATAGTGAAA\nATGACCAACTACGTAATAAGAATCATGTAAAATAATATCAATTGATGAATTTGATAATAT\nAATTCCTGTTAATCCTCCAATAGTAAATATTAAAATAAATCCAATTGATCATATAAATGA\nAATATTAAAATTTAATTTTGATCCATGATAAGTTGCTAATCATCTAAAAACTTTAATTCC\nTGTAGGAATTGCAATAATTATTGTTGCAGATGTAAAATATGCTCGTGTATCAACATCTAA\nTCCTACAGTAAATATATGATGAGCTCATACAATAAATCCTAAAAATCCAATTCCTAATAT\nAGCATAAATTATTCTTAAATTTCCAAAAATTTCCTTTTTTCCTCTTTCATTTATAATAAT\nTTGTGAAATTAGTCCAAATCCTGGTAAAATTAAAATATAAACTTCTGGATGACCAAAAAA\nTCAAAATAAATGTTGATAA\n```\n\n## Alinhamento das sequnências\n\nAs sequências finais foram Alinhadas via [BLASTn online](https://blast.ncbi.nlm.nih.gov/Blast.cgi?PROGRAM=blastn&PAGE_TYPE=BlastSearch&LINK_LOC=blasthome) contra o banco de dados `core_nt`, uma versão reduzida e clusterizada do banco total de nucleotídeos `nt`.\n\n# Resultados\n\n## Qualidade das Sequências\n\nA qualidade sequências dos arquvos *FASTQ* foram realizadas com o software **FastQC** e depois agragadas com o software **MultiQC**. As qualidades foram medidas antes e depois da remoção de sequências de baixa qualidade.\n\n![Qualidade das sequências SEM a remoção das bases de baixa qualidade](figures/pre_trim.png)\n\n![Qualidade das sequências COM a remoção das bases de baixa qualidade](figures/pos_trim.png)\n\n## Sequências montadas\n\nAs sequências fasta (*foward* e *reverse*) foram unidas em arquivos únicos para cada código e amostra, **COC_merged.fasta**; **MAC_merged.fasta** e **RBA_merged.fasta**. Esses arquivos foram montados utilizando o software CAP3 e tiveram como resultado final os seguintes tamanhos em bases: \n\n| Amostra | Tamanho (nt) |\n|--------|--------|\n| COC | 615 |\n| MAC | 607 |\n| RBA | 617 |\n\n: Tamanho das sequências em nucleotídeos {.striped .hover}\n\nComo resultado da montagem, temos o arquivo FASTA final para cada sequência:\n\n```{bash}\n\n>COC\nTTATCAACATTTATTTTGATTTTTTGGTCATCCAGAAGTTTATATTTTAATTTTACCAGG\nATTTGGACTAATTTCACAAATTATTATAAATGAAAGAGGAAAAAAGGAAATTTTTGGAAA\nTTTAAGAATAATTTATGCTATATTAGGAATTGGATTTTTAGGATTTATTGTATGAGCTCA\nTCATATATTTACTGTAGGATTAGATGTTGATACACGAGCATATTTTACATCTGCAACAAT\nAATTATTGCAATTCCTACAGGAATTAAAGTTTTTAGATGATTAGCAACTTATCATGGATC\nAAAATTAAATTTTAATATTTCATTTATATGATCAATTGGATTTATTTTAATATTTACTAT\nTGGAGGATTAACAGGAATTATATTATCAAATTCATCAATTGATATTATTTTACATGATTC\nTTATTACGTAGTTGGTCATTTTCACTATGTATTATCTATAGGAGCAGTATTTTCCATTAT\nTGCAAGATTTATTCATTGATTTCCCTTATTATCAGGATTAATAATTAATCAAAAATGATT\nAAAATTTCAATTTTTTTTTATATTCATTGGAATTAATTTCACTTTTTTTCCTCAACATTT\nTTTAGGATTAATATC\n\n>RBA\nTTATCAACATTTATTTTGATTTTTTGGTCATCCAGAAGTTTATATTTTAATTTTACCAGG\nATTTGGACTAATTTCACAAATTATTATAAATGAAAGAGGAAAAAAGGAAATTTTTGGAAA\nTTTAAGAATAATTTACGCTATATTAGGAATTGGATTTTTAGGATTTATTGTATGAGCTCA\nTCATATATTTACTGTAGGATTAGATGTTGATACACGAGCATATTTTACATCTGCAACAAT\nAATTATTGCAATTCCTACAGGAATTAAAGTTTTTAGATGATTAGCAACTTATCATGGATC\nAAAATTAAATTTTAATATTTCATTTATATGATCAATTGGATTTATTTTAATATTTACTAT\nTGGAGGATTAACAGGAATTATATTATCAAATTCATCAATTGATATTATTCTACATGATTC\nTTATTACGTAGTTGGTCATTTTCACTATGTATTATCTATAGGAGCAGTATTTTCCATTAT\nTGCAAGATTTATTCATTGATTTCCCTTATTATCAGTGATTAATAATTAATCAAAAATGAT\nTAAAATTTCAATTTTTTTTTATATTCATTGGAATTAATTTAACTTTTTTTCCTCAACATT\nTTTTAGG\n\n>MAC\nTTATCAACATTTATTTTGATTTTTTGGTCATCCAGAAGTTTATATTTTAATTTTACCAGG\nATTTGGACTAATTTCACAAATTATTATAAATGAAAGAGGAAAAAAGGAAATTTTTGGAAA\nTTTAAGAATAATTTATGCTATATTAGGAATTGGATTTTTAGGATTTATTGTATGAGCTCA\nTCATATATTTACTGTAGGATTAGATGTTGATACACGAGCATATTTTACATCTGCAACAAT\nAATTATTGCAATTCCTACAGGAATTAAAGTTTTTAGATGATTAGCAACTTATCATGGATC\nAAAATTAAATTTTAATATTTCATTTATATGATCAATTGGATTTATTTTAATATTTACTAT\nTGGAGGATTAACAGGAATTATATTATCAAATTCATCAATTGATATTATTTTACATGATTC\nTTATTACGTAGTTGGTCATTTTCACTATGTATTATCTATAGGAGCAGTATTTTCCATTAT\nTGCAAGATTTATTCATTGATTTCCCTTATTATCAGGATTAATAATTAATCAAAAATGATT\nAAAATTTCAATTTTTTTTTATATTCATTGGAATTAATTTCACTTTTTTTCCTCAACATTT\nTTTAGGATTTAATATCA\n\n```\n\n## Alinhamento no BLAST\n\nFoi realizado o alinhamento global das sequências em um banco de dados de nucleotídeos (*NCBI Core NT*), os resultados foram os seguintes:\n\n\n| Amostra | Melhor Hit | Organismo |\n|--------|--------|--------|\n| COC | H2 cytochrome c oxidase subunit I (COI) gene | *Partamona rustica* |\n| MAC | H2 cytochrome c oxidase subunit I (COI) gene | *Partamona rustica* |\n| RBA | H5 cytochrome c oxidase subunit I (COI) gene | *Partamona rustica* |\n\n: Melhores resultados do alinhamento no BLAST para cada amostra {.striped .hover}\n\nOs alinhamentos tiveram índices de identidade e cobertura maiores que 99% para os melhores alinhamentos.\n\nAs sequências aparentam ser derivadas da espécie *Partamona rustica*, especificamente vindas de subunidades H do gene **citocromo c oxidase**, sendo uma enzima na cadeia respiratória de transporte de elétrons das células. \n\n",
    "supporting": [
      "seq_sanger_files"
    ],
    "filters": [],
    "includes": {}
  }
}